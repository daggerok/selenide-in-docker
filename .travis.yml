service:
- docker

env:
  global:
  - TERM=dumb

language: java
jdk: oraclejdk8

addons:
  apt:
    update: true
    packages:
    - libappindicator1
    - fonts-liberation
    - wget
    - bash
    - docker-ce

install: true
before_script:
- export CHROME_BIN=/usr/bin/google-chrome
- export DISPLAY=:99.0
- sh -e /etc/init.d/xvfb start
- wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
- sudo dpkg -i google-chrome*.deb

script:

- echo "this build in Travis locally works as expected with bot firefox and chrome browsers!"
- bash gradlew -S check chrome
- bash gradlew -S check headless chrome
- bash gradlew -S check firefox
- bash gradlew -S check headless firefox

- echo "this build using firefox / headless firefox in Dockerfile now is also is running well ...finally"
- docker build -f Dockerfile-firefox -t tests .
- docker run --rm --name run-tests -v ~/.gradle:/home/e2e/.gradle -v ~/.m2:/home/e2e/.m2 tests

cache:
  directories:
  - $HOME/.m2
  - $HOME/.gradle
